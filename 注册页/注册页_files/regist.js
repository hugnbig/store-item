var _gaq=_gaq||[];function AuthPasswd(d,e){if(d.length>=6){var c=0;d.match(/[a-z]/g)&&c++;d.match(/[A-Z]/g)&&c++;d.match(/[0-9]/g)&&c++;d.match(/^[a-zA-Z0-9]/g)&&c++;c=c>3?3:(c-1);d.length<8&&c>1&&(c=1);noticeAssign(c)}else{e.errorElem.html(e.msg)}}function noticeAssign(c){var b="",a="";switch(c){case 1:b='<span style="color:#169021;">弱</span>';break;case 2:b='<span style="color:#FF7300;">中</span>';break;case 3:b='<span style="color:#E20001;">强</span>';break;default:b=""}if(b!=""){a='密码强度：<span class="pwd pwd_'+c+'"></span>'+b;if(document.getElementById("register_password_a")){document.getElementById("register_password_a").innerHTML=a}if(document.getElementById("find_password_a")){document.getElementById("find_password_a").innerHTML=a}}}function Check(a){this.setting=a;a.elem.setting=a;this.addEvent()}Check.prototype={constructor:Check,addEvent:function(){var b=this.setting,a=b.elem;a.on("focus",function(){UR.focusPrev(b)});a.on("blur",function(){UR.blurPrev(b)});b.eventType&&a.on(b.eventType,b.eventFunction);b.firstFocus&&a.focus()}};var UR={changeCaptcha:function(c,b){if(!c){return}if(b){var a=c[0];while(a){a=a.previousSibling;if(a&&a.nodeName=="INPUT"){a.value="";a.focus();break}}}$.getCaptcha(c)},getSmsCaptcha:function(){var a=$("#register_mobile").val(),c=$("#register_captcha").val(),b=$("#register_username").val(),e="",d=this;if(this.lock){return}if($("#register_mobile_a").hasClass("error2")){return false}if(!c){$.alert("请填写验证码！");return false}if(!window.CAPTCHA_CHCEKED){$.alert("验证码不正确！");return false}this.lock=true;$.get("/dubbo_api/user/register/checkMobile?mobile_phone="+a,function(f){if(f.exist){return}e="phoneNumber="+a+"&captcha="+c+"&captchaType=register&durationTime=3000&checkSufEff=0";$.ajax({url:"/solr_api/captcha/mobileCaptcha/create_send_check_captcha.do?"+e,dataType:"json",cache:false,success:function(g){d.lock=false;if(g&&!g.error){UR.smsCaptchaTimer=120;$("#send_sms_captcha_wait").css("display","inline-block");$("#send_sms_captcha_a").css("display","none");$("#sms_captcha_s_a").css({"visibility":"hidden","display":""});$("#sms_capteha_send").css("display","");UR.countSmsCaptcha();(function(h){if(window.goSpread){var i={},j={send_sms:{phone:h||"13800138000",email:"mllcustomer@meilele.com"}};i.data=j;window.goSpread(["_trackRTEvent",i])}window.goGdt&&window.goGdt([["add_action","SHOP_VIEW",h||"13800138000","mllcustomer@meilele.com"]])})()}else{$.alert(g.msg)}$.getCaptcha($("#JS_captcha"));$("#register_ver_s").css("display","none")},error:function(){d.lock=false;$.alert("获取短信验证码失败，请稍候再试。")}})})},countSmsCaptcha:function(){if(UR.smsCaptchaTimer<=0){$("#send_sms_captcha_wait").css("display","none");$("#sms_capteha_send").css("display","none");$("#send_sms_captcha_a").css("display","inline-block");return}$("#send_sms_captcha_wait").text(UR.smsCaptchaTimer+"秒后重新发送");UR.smsCaptchaTimer--;setTimeout(UR.countSmsCaptcha,1000)},checkFunction:function(f){var h=f.elem.val(),a=h.length,b=f.maxLength,d=f.minLength,e=f.pattent||"",c=f.extendPattent||"",g=f.checkOnline;if(a==0){UR.showError(true,f,f.defaultTip);return false}if((b&&a>b)||(d&&a<d)){UR.showError(true,f,f.lengthError);return false}if(f.repOppose){if(e&&e.test(h)){UR.showError(true,f,f.ruleError);return false}}else{if(e&&!e.test(h)){UR.showError(true,f,f.ruleError);return false}}if(f.extentRepOppose){if(c&&c.test(h)){UR.showError(true,f,f.extendError);return false}}else{if(c&&!c.test(h)){UR.showError(true,f,f.extendError);return false}}if(f.otherRepOppose){if(f.otherPattent&&f.otherPattent.test(h)){UR.showError(true,f,f.otherError);return false}}else{if(f.otherPattent&&!f.otherPattent.test(h)){UR.showError(true,f,f.otherError);return false}}if(f.checkPassword&&f.pwElem.val()!=h){UR.showError(true,f,f.ruleError);return false}if(f.checkOnline){UR.checkValueOnline(h,f);return false}UR.showSuccess(true,f)},focusPrev:function(a){UR.showSuccess(false,a);a.focusFunction&&a.focusFunction()},blurPrev:function(a){UR.checkFunction(a);a.blurFunction&&a.blurFunction()},showError:function(b,a,c){if(b){a.elem.addClass("users_input_error");a.errorElem.addClass("error2").text(c).css("visibility","visible")}if(a.required){a.elem.addClass("wrong")}a.elem.addClass("users_input_error")},showSuccess:function(b,a){a.elem.removeClass("users_input_error");if(b){a.errorElem.css("visibility","hidden");a.successElem.show();if(a.required){a.elem.removeClass("wrong")}}else{a.errorElem.removeClass("error2");a.successElem.hide()}},checkValueOnline:function(d,c){var b=c.ajaxUrl,a=b.indexOf("?")>=0?"&":"?";b+=a+c.keyName+"="+encodeURIComponent(d);if(c.extraData){b+=(c.extraData()||"").replace(/^\?/,function(){return b.indexOf("?")>=0?"&":"?"})}$.ajax({type:"GET",url:b,dataType:"json",cache:false,success:function(e){if(e){if(e.error==0||e.msg=="success"){UR.showSuccess(true,c)}else{var f=e.msg=="error"?c.lengthError:e.msg;UR.showError(true,c,f);if(e.exist==true&&$("#register_mobile_a").length&&b.indexOf("checkMobile")!=-1){$("#register_mobile_a").append('<a style="color:#4a92f5;margin-left:6px;" href="/user/?act=login">直接登录</>');$("#sms_captcha_e").hide();$("#sms_captcha_s_a").css("display","none")}}}}})},formSubmit:function(){var a=UR.serialize("JS_register_form");a.captcha_type="register";a.register_origin="WEB";$("#register_submit0").addClass("none");$("#register_submit1").removeClass("none");$.ajax({url:"/dubbo_api/user/register/web",type:"post",data:a,dataType:"json",cache:false,success:function(b){if(b&&b.error==0){location.href="/user/?act=regist_namesuccess&username="+a.user_name}else{$.alert(b.msg);$.getCaptcha($("#JS_captcha"));$("#register_submit1").addClass("none");$("#register_submit0").removeClass("none")}},error:function(b){$.alert(b.msg);$.getCaptcha($("#JS_captcha"));$("#register_submit1").addClass("none");$("#register_submit0").removeClass("none")}})},serialize:function(f){var d=document.getElementById(f);var c,b,e={};for(c=0;c<d.elements.length;c++){if(d.elements[c].name===""){continue}if(d.elements[c].parentNode&&d.elements[c].parentNode.tagName.toLowerCase()=="p"&&d.elements[c].parentNode.style.display=="none"){continue}var a=d.elements[c].name;switch(d.elements[c].nodeName){case"INPUT":switch(d.elements[c].type){case"text":case"hidden":case"password":if(!d.elements[c].disabled){e[a]=d.elements[c].value}break;case"checkbox":if(!!d.elements[c].checked){e[a]=1}else{e[a]=0}break}break}}return e}};
/*mazengliang:2016-06-16 14:49:59*/