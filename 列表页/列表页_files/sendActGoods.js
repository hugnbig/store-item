window._gaq=window._gaq||[];$.ajaxSetup({cache:false});$.sendActGoods=function(b,a){new $.sendActGoods.prototype.init(b,a);};$.sendActGoods.prototype={constructor:$.sendActGoods,startTime:new Date()-0,bg:($.__IMG||"http://image.meilele.com")+"/images/common/actgoods_bg.png?v2",styleInserted:false,defaultCfg:{_default:{title:"免费发送到手机"},get_limited_prize:{title:"领取无敌劵",sendType:51,sendSource:1,createCaptchaUrl:"/dubbo_api/mll/mobileCaptcha/create_send_check_captcha",btnText:"免费领取",gaEvent:"jjc_yhq"},get_bk_tx:{title:"开抢前5分钟免费提醒",btnText:"开售提醒",successTxt:"订阅成功",successSubTxt:"我们将会在开抢前5分钟发送短信提醒您。",gaEvent:"jjc_bkth"},get_ms_tx:{title:"秒杀报名",sendType:50,sendSource:1,createCaptchaUrl:"/dubbo_api/mll/mobileCaptcha/create_send_check_captcha",captchaType:"miaosha_baoming",btnText:"开抢提醒",successTxt:"报名成功！",successSubTxt:"请在活动开始前5分钟登录准备。",gaEvent:"jjc_djms"},get_tg_tx:{title:"团购报名",sendType:6,sendSource:1,createCaptchaUrl:"/dubbo_api/mll/mobileCaptcha/create_send_check_captcha",captchaType:"tg_baoming",btnText:"开团提醒",successTxt:"订阅成功",successSubTxt:"我们将会在开团前5分钟短信提醒您。",gaEvent:"jjc_lft"},get_pm_bm:{title:"拍卖报名",btnText:"马上报名",ajaxType:"POST",successTxt:"报名成功！",successSubTxt:"请到您选择的体验馆进行拍卖。",gaEvent:"jjc_pm"},get_tg_bm:{title:"团购报名",sendType:6,sendSource:1,createCaptchaUrl:"/dubbo_api/mll/mobileCaptcha/create_send_check_captcha",captchaType:"tg_baoming",btnText:"马上报名",successTxt:"报名成功！",gaEvent:"jjc_lft"}},init:function(b,a){if($._currentsendActGoodsBox&&$._currentsendActGoodsBox.hasShow){return;
}$._currentsendActGoodsBox=this;$._currentsendActGoodsBox.hasShow=true;this.setting=$.extend({type:"_default",phoneNumber:$.cookie("sendSmsPhone")||false,autoSend:false,checkPhone:false,chooseExpr:true,defaultCityId:parseInt($.cookie("region_id")),onSuccess:function(){}},a);
this.cfg=this.defaultCfg[this.setting.type]||this.defaultCfg._default;this.cfg.title=this.setting.boxTitle||this.cfg.title;if(this.setting.exprInfo&&this.setting.exprInfo.exprList){delete this.setting.exprInfo.exprList;
}this.exprId=b;this.setStyleRule();this.getIsNeedImgChap();this.dom=this.show();if(this.setting.chooseExpr){this.initExpr();}else{this.init2();}if(this.setting.type=="get_pm_bm"&&this.setting.exprInfo&&this.setting.exprInfo.cityName&&!$("#_JS_sndSms_city_select_").html()){this.insertCitySelect();
}if(!!window.ActiveXObject&&!window.XMLHttpRequest){$._currentsendActGoodsBox.getScrollTop();$(window).scroll(function(){$._currentsendActGoodsBox.getScrollTop();
});}},initExpr:function(){$._currentsendActGoodsBox.storage=window.JSON&&window.JSON.parse&&window.localStorage&&window.localStorage.setItem&&window.localStorage;
if($._currentsendActGoodsBox.storage&&$._currentsendActGoodsBox.storage.sendSmsStorage){var a=JSON.parse($._currentsendActGoodsBox.storage.sendSmsStorage);
$._currentsendActGoodsBox.day=(new Date().getTime()-a.expire)/(1000*3600*24);if($._currentsendActGoodsBox.day<1){this.analysisExprList(a,this.init2);this.initData(this.init2,"&contentType=1");
}}if(!$._currentsendActGoodsBox.storage||!$._currentsendActGoodsBox.storage.sendSmsStorage||($._currentsendActGoodsBox.storage&&$._currentsendActGoodsBox.storage.sendSmsStorage&&$._currentsendActGoodsBox.day>=1)){this.initData(this.init2);
}},getScrollTop:function(){var a=$(window).scrollTop()+150;$(".sms_lightbox").css({top:a+"px"});},analysisExprList:function(e,i){this.exprInitData={};this.callback=i;
var g={};if(this.exprId){for(var c=0;c<e.expr_list.length;c++){if(e.expr_list[c]&&e.expr_list[c].expr_id==this.exprId){this.setting.defaultCityId=e.expr_list[c].city_id;
break;}}}for(var c=0;c<e.expr_list.length;c++){var f=e.expr_list[c];var b=f.province_id;var h=f.city_id;var a=f.expr_id;this.exprInitData[a]=f;if(!g[b]){g[b]={provinceName:f.province__name,cityList:{}};
}if(!g[b].cityList[h]){g[b].cityList[h]={cityName:f.city__name,exprList:{},exprInfo:{}};}g[b].cityList[h].exprList[a]=f.expr_alias;g[b].cityList[h].exprInfo[a]=f;
if(h==this.setting.defaultCityId||(this.setting.exprInfo&&this.setting.exprInfo.cityName==f.city__name)){this.selectedProvinceId=b;this.selectedCityId=h;
this.setting.exprInfo=this.setting.exprInfo||{};this.setting.exprInfo.cityName=f.city__name;this.setting.exprInfo.exprList=this.setting.exprInfo.exprList||[];
this.setting.exprInfo.exprList.push({exprName:f.expr_alias,exprId:f.expr_id,position:f.position,need_appointment:f.need_appointment});}}this.successAdInfo=e.ad_info;
this.real_expr_num=e.real_expr_num;this.cityInfo=g;if(!this.selectedProvinceId&&!this.selectedCityId){this.insertCitySelect();}else{this.insertExprSelect();
}if(this.callback){this.callback.call(this,e);}},getPrizeNum:function(a){this.prize_num=a.prize_num;if(a.prize_num>0){if($._currentsendActGoodsBox.setting.type=="get_limited_prize"){return;
}$("#JS_sms_prize_num_box").html(a.prize_num).parent().show();}},initData:function(e,d){var c=this.setting.type+"_success_notice";var b=this;var a="/mll_api/api/send_message&type="+this.setting.type+(this.setting.unique?"&activity="+this.setting.unique:"")+"&ad_code="+c+(d?d:"");
$.ajax({url:a,dataType:"json",success:function(f){if(d){b.getPrizeNum(f);}else{b.analysisExprList(f);b.getPrizeNum(f);if($._currentsendActGoodsBox.storage||($._currentsendActGoodsBox.storage&&$._currentsendActGoodsBox.day>1)){f.expire=new Date().getTime();
$._currentsendActGoodsBox.storage.setItem("sendSmsStorage",JSON.stringify(f));}}if(e){e.call(b,f);}},error:function(){this.remove();$.alert("发生网络错误，请稍候再试！");
}});},init2:function(){if(this.init2IsReady){return;}this.init2IsReady=true;var a=this.exprId;this.exprId=a;if(!this.selectedProvinceId&&!this.selectedCityId){this.insertCitySelect();
}else{this.insertExprSelect();}this.msgBox=$("#_JS_sndSms_msg_box_");this.inpt=$("#_JS_sndSms_input_");this.btn=$("#_JS_sndSms_btn_");this.captcha=$("#_JS_sndSms_captcha_");
this.captchaImg=$("#_JS_sndSms_captchaImg_");this.cellcaptcha=$("#_JS_sndSms_prz_cellcaptcha_");this.realname=$("#_JS_sndSms_rname_input_");this.mBox=$("#_JS_sms_title_box");
this.sBox=$("#_JS_sms_box");if(!this.initMouseDownEvent){this.mBox.on("mousedown",function(b){if(b&&b.preventDefault){b.preventDefault();}else{event.returnValue=false;
}$._currentsendActGoodsBox.x=b.pageX;$._currentsendActGoodsBox.y=b.pageY;$._currentsendActGoodsBox.marginLeft=parseInt($._currentsendActGoodsBox.sBox.css("margin-left"));
$._currentsendActGoodsBox.marginTop=parseInt($._currentsendActGoodsBox.sBox.css("margin-top"));$._currentsendActGoodsBox.isMousedown=true;});$(document).on("mousemove",function(d){if($._currentsendActGoodsBox&&$._currentsendActGoodsBox.isMousedown){var c=d.pageX-$._currentsendActGoodsBox.x+$._currentsendActGoodsBox.marginLeft;
var b=d.pageY-$._currentsendActGoodsBox.y+$._currentsendActGoodsBox.marginTop;$._currentsendActGoodsBox.sBox.css({"margin-left":c+"px","margin-top":b+"px"});
}}).on("mouseup",function(){if($._currentsendActGoodsBox){$._currentsendActGoodsBox.isMousedown=false;}});this.initMouseDownEvent=true;}this._mobile_captcha_times_limit_g=window._mobile_captcha_times_limit||120;
this.inpt.on("blur",$._currentsendActGoodsBox.hiddenPhone);if(this.setting.checkPhone){this.setting.flag=0;this.setting.pNumber=0;this.insertCellCaptcha();
this.inpt.on("focus",$._currentsendActGoodsBox.value_null);$("#_JS_sndSms_prz_cellcaptcha_").on("change",$._currentsendActGoodsBox.checkCellCaptcha);this.cellcaptcha_flag=false;
}if(this.setting.notice){$("#_JS_sndSms_notice").html(this.setting.notice).show();}if(this.setting.phoneNumber){$._currentsendActGoodsBox.hiddenPhone();
}if(this.setting.phoneNumber&&this.setting.autoSend){this.send();}this.getCaptcha(this.setting.captchaSrc);if(this.isNeedImgChap){this.captcha_flag=false;
}else{this.captcha_flag=true;}this.captcha_icon=$("#_JS_sendSms_captcha_icon");$.checkCaptcha(this.captcha,{success:function(){var b=$._currentsendActGoodsBox.captcha_icon;
b.addClass("sms_captcha_success");b.removeClass("sms_captcha_error");$._currentsendActGoodsBox.captcha_flag=true;},error:function(){var b=$._currentsendActGoodsBox.captcha_icon;
b.removeClass("sms_captcha_success");b.addClass("sms_captcha_error");$._currentsendActGoodsBox.captcha_flag=false;}});},setStyleRule:function(){if(!this.styleInserted){var a=[];
var b;a.push(".actgoods_lightBox{top:"+(($(window).height()-440)/2)+"px;}");a.push(".actgoods_lightBox .sms_box{width:427px;background:#fff;overflow:hidden;position:absolute;margin-left:435px;z-index:9;}");
a.push(".root-body .actgoods_lightBox .sms_box{margin-left:516px;}");a.push("#JS_mask{min-width:1190px;}");a.push(".actgoods_lightBox .sms_box_header{height:45px;padding-top:10px;background:url("+this.bg+") 0 0 repeat-x;}");
a.push(".actgoods_lightBox .sms_box_header.no-header-bg{background:#fff;}");a.push(".actgoods_lightBox .sms_title_box{height:38px;width:342px;cursor:move;position: absolute;line-height:40px;color:#cf000e;font-size:16px;font-weight:bold;font-family:微软雅黑;padding-left:20px;overflow:hidden;padding-bottom:10px;background:transparent;border-bottom:none;}");
a.push(".sms_content {padding-top:40px;}");a.push(".sms_content .red {color: #c9033b;line-height:22px;}");a.push(".actgoods_lightBox .sms_input {width:230px;background: #fff;border:1px solid #ddd;padding:8px 0 8px 6px;margin:0;color:#555;height:16px;}");
a.push("._sms_shadow:focus{transition:border linear .2s,box-shadow linear .2s;-moz-transition:border linear .2s,-moz-box-shadow linear .2s;-webkit-transition:border linear .2s,-webkit-box-shadow linear .2s;outline:none;border-color:#6db9e0;box-shadow:0 0 4px #7fcaf1;-moz-box-shadow:0 0 4px #7fcaf1;-webkit-box-shadow:0 0 4px #7fcaf1;}");
a.push(".actgoods_lightBox .sms_captcha {width:68px;background:#fff;border:1px solid #ddd;padding:7px 0 7px 5px;margin:0;vertical-align:top;color:#555;}");
a.push(".actgoods_lightBox .sms_content label {width:100px;height:28px; line-height: 28px;text-align:right;display:inline-block;vertical-align:top;}");
a.push(".actgoods_lightBox .sms_submit{height:36px;width:236px;color:#fff;text-align:center;border:solid 1px #cf000e;margin:0;padding:0;font-weight:bold;line-height:34px;background:#cf000e;font-size:15px;font-family:微软雅黑;cursor:pointer;}");
a.push("._sndsms_select{background: #fafafa;border:0px;margin:0;padding:0px;width:150px;}");a.push("#_JS_sndSms_city_list_,#_JS_sndSms_province_list_{width:95px;}");
a.push("._check_icon{display:inline-block;height:15px;width:15px;margin-top:9px;margin-left:4px;vertical-align:2px;}");a.push(".sms_captcha_success{background:url("+$.__IMG+"/images/common/site/site.png) -92px -77px no-repeat;_background:url("+$.__IMG+"/images/common/site/site.gif) -92px -77px no-repeat;}");
a.push(".sms_captcha_error{background:url("+$.__IMG+"/images/common/site/site.png) -92px -92px no-repeat;_background: url("+$.__IMG+"/images/common/site/site.gif) -92px -92px no-repeat;margin-left:4px;vertical-align:2px;}");
a.push(".prz_captcha {width:60px;}");a.push(".actgoods_lightBox .prz_yuanjiao {background:#fff;text-align:center;font-family:微软雅黑;border:1px solid #ddd;padding:6px 6px;display:inline-block;margin-left:8px;height:16px;width:62px;color:#cf000e;}");
a.push(".prz_cellcaptcha {width:68px;}");a.push(".prz_sure_inline{display:inline-block;}");a.push(".prz_sure {margin-left:10px;width:100px;height:20px;padding-top:8px;color:#0099CC;display:none;}");
a.push(".actgoods_lightBox .prz_yuanjiao3 {width:100px;color:#999999;background-color:#fafafa;display:none;}");a.push(".actgoods_lightBox .prz_yuanjiao5 {width:136px;color:#999999;background-color:#fafafa;display:none;margin-left:5px;}");
a.push(".sms_content .twoDimensionCodeStage{width:367px;border-top: dotted 1px #e1e1e1;margin:10px auto 0 auto;padding-top:15px;text-align:center;}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode {height:82px;padding:0 11px;margin:0 auto;overflow:hidden;}");
a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode a{display:inline-block;padding-left:10px;height:82px;}");a.push(".actgoods_lightBox .sms_msg_box{color:#cf000e;padding:8px 20px 7px 130px;text-align:left;}");
a.push(".sms_content label,.sms_content option,.sms_content select{color:#333;}");a.push(".sms_content label{font-size:14px;font-family:微软雅黑}");a.push(".sms_content .twoDimensionCodeStage {width:auto;background:#fff8ee url(http://image.meilele.com/images/zhuanti/upload/h4_1398411049.jpg) 0 0 repeat-x;border-top:none}");
a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode{height:auto;padding-bottom:10px;}");a.push(".actgoods_lightBox .sms_close_btn{display:inline-block;width:18px;height:18px;background:url("+this.bg+") -25px -103px no-repeat;}");
a.push(".actgoods_lightBox .sms_close_btn.gray{background-position:-44px -103px;}");a.push(".actgoods_lightBox .no-header-bg .sms_close_btn{color:#333;}");
a.push(".sms_close_btn:hover{text-decoration:none}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode a{height:74px;}");a.push(".sms_content .twoDimensionCodeStage .twoDimensionCode a{height:auto;padding-bottom:5px;}");
a.push('.sms_main_box .sndSms_notice {width: 325px; height: auto; background: #f7f3cd; color: #e18f00; margin: 0 auto; margin-bottom: 12px; text-align: center; padding: 5px 10px;font-family: "Microsoft Yahei"; display: none;}');
a.push('.suc_Sms_notice{width:325px;height:auto;background:#f5f5f5;color:#ff8b00;margin:-50px auto 50px auto;padding: 5px 10px;font-family: "Microsoft Yahei";}');
$.insertStyle(a.join(""));this.styleInserted=true;}},show:function(){var a=this.setting.mobile_default_text||"请输入您的手机号";var e="";var c="";e+='<div class="w" style="position:relative;">';
e+='<div class="sms_box" id="_JS_sms_box">';e+='<div class="sms_box_header"><div style="position:absolute;z-index:11;margin: 12px 0 0 385px;" ><a class="sms_close_btn" href="javascript:;" onclick="$._currentsendActGoodsBox.remove();"></a></div><div class="sms_title_box" id ="_JS_sms_title_box"><div id="_JS_sndSms_title_">'+(this.setting.title||this.cfg.title||"免费发送到手机").replace("{number}",this.real_expr_num||"--")+"</div></div></div>";
e+='<div class="sms_content" id="_JS_sndSms_content_box" style="">';e+='<div class="sms_main_box" style="padding-left:20px;">';e+='<div id="_JS_sndSms_notice" class="sndSms_notice"></div>';
if($._currentsendActGoodsBox.setting.type=="get_pm_bm"){e+='<div id="_JS_sndSms_realname" style="margin-bottom:15px;"><label for="_JS_sndSms_rname_input_">真实姓名：</label><input class="sms_input _sms_shadow"  id="_JS_sndSms_rname_input_" name="apply_user_name" /></div>';
}if($._currentsendActGoodsBox.setting.chooseExpr){e+='<div id="_JS_sndSms_city_select_"></div>';e+='<div id="_JS_sndSms_expr_select_"></div>';}e+='<div id="JS_phone_boxdiv"><label for="_JS_sndSms_input_">手机号：</label><input class="sms_input _sms_shadow" style="margin-right:5px;vertical-align:top;" value="'+(this.setting.phoneNumber||a)+'" onfocus="if(this.value==\''+a+'\')this.value=\'\';$(\'#_JS_sendSms_phone_icon\').hide();" onkeypress="$._currentsendActGoodsBox.keyPress(event);" onblur="$._currentsendActGoodsBox.phoneOnBlur(this);" id="_JS_sndSms_input_" name="_JS_sndSms_input_" /><span class="_check_icon" id="_JS_sendSms_phone_icon"></span></div>';
e+='<div><span id="_JS_sndSms_prz_tishiA" style="margin-left:110px;margin-top:3px;display:none;"></span></div>';if($._currentsendActGoodsBox.isNeedImgChap){e+='<div style="margin-top:15px;" id="JS_img_check_box"><label for="_JS_sndSms_captcha_">验证码：</label><input class="sms_captcha _sms_shadow" value="'+(this.setting.captcha||"")+'" onfocus="$._currentsendActGoodsBox.msgBox.html(\'\');if(this.value==\'验证码\')this.value=\'\'" id="_JS_sndSms_captcha_" name="_JS_sndSms_captcha_" onkeypress="$._currentsendActGoodsBox.keyPress(event);" ><img src="http://image.meilele.com/themes/paipai/images/blank.gif" style="width:75px;margin-right:5px;height:30px;vertical-align:top;margin-left:8px;cursor:pointer" title="换一张" onclick="$._currentsendActGoodsBox.getCaptcha();$._currentsendActGoodsBox._reset_captcha();return false;" id="_JS_sndSms_captchaImg_" /><a href="javascript:;" style="color:#0072ca;vertical-align:5px;" onclick="$._currentsendActGoodsBox.getCaptcha();$._currentsendActGoodsBox._reset_captcha();return false;">看不清，换一张</a>';
e+='<span class="_check_icon" id="_JS_sendSms_captcha_icon"></span>';e+="</div>";}e+='<div id="_JS_sndSms_cellcaptcha_"></div>';e+="</div>";e+='<div style="padding: 20px 0 35px 0;">';
e+='<div><label style="width:120px;"></label><input id="_JS_sndSms_btn_" type="button" class="pointer sms_submit" onclick="$._currentsendActGoodsBox.send();" value="'+this.cfg.btnText+'" />&emsp;';
e+="</div>";e+='<div class="sms_msg_box" id="_JS_sndSms_msg_box_"></div>';e+="</div>";e+="</div>";e+="</div>";e+="</div>";e+="";if(window._ana){if(this.setting.type=="get_bk_tx"&&this.setting.click=="家具城爆款特惠订阅"){window._ana.push(["trackEvent",this.setting.gaEvent||this.cfg.gaEvent,'点击"开抢提醒"',"remind_grab",this.setting.phoneNumber||"unset","jjc_yhq"]);
}else{window._ana.push(["trackEvent",this.setting.gaEvent||this.cfg.gaEvent,"click",this.setting.phoneNumber||"unset",this.exprId||"unset",this.setting.click]);
}}if(window._gaq){window._gaq.push(["_trackEvent",this.setting.gaEvent||this.cfg.gaEvent,"click",this.setting.click]);}$.showMask();var b=$.lightBox(e,{},true,false,false,false,"actgoods_lightBox");
$("#_JS_sndSms_map_").click(function(){$("#_JS_sndSms_content_box select:visible").each(function(){var d=$(this);if(d&&!parseInt(d.val())){d.parent().css("border-color","#c9033b");
return false;}});});return b;},insertCellCaptcha:function(){str="";str+='<div style="margin-top:15px;"><label>手机校验码：</label>';str+='<input id="_JS_sndSms_prz_cellcaptcha_" class="prz_input prz_cellcaptcha sms_captcha _sms_shadow" value="" onfocus="if(this.value==\'手机验证码\')this.value=\'\'" ><span id="_JS_sndSms_prz_btn2_" onclick="$._currentsendActGoodsBox.getCellCaptcha();" class="pointer prz_yuanjiao prz_yuanjiao2">免费获取</span>';
str+='<span id="_JS_sndSms_prz_btn5_" class="prz_yuanjiao prz_yuanjiao5">(0秒后) 重新获取短信</span>';str+='<span id="_JS_sndSms_prz_btn6_" style="color:#333" onclick="$._currentsendActGoodsBox.getCaptchaAgin();" class="pointer prz_yuanjiao prz_yuanjiao3">重发短信校验码</span>';
str+="</div>";$("#_JS_sndSms_cellcaptcha_").html(str);},selectedExpr:function(a){$._currentsendActGoodsBox.exprId=a;$("#_JS_expr_select_box").css("border-color","#ddd");
},insertExprSelect:function(){str="";str+='<div class="clearfix" style="height:46px;"><label class="Left">体验馆：</label><div class="_selectbox Left" id="_JS_expr_select_box" style="height:25px;padding-top:5px;border:1px solid #ddd;"><select id="JS_sms_epr_select_se" style="background: #fafafa;border:0px;margin:0;padding:0px;width:150px;" onchange="$._currentsendActGoodsBox.selectedExpr(this.value);">';
str+='<option value="0">请选择体验馆('+this.setting.exprInfo.exprList.length+"家)</option>";for(var a=0;a<this.setting.exprInfo.exprList.length;a++){var b="";
if(this.setting.exprInfo.exprList.length==1||this.exprId==this.setting.exprInfo.exprList[a].exprId){b=' selected="selected"';this.exprId=this.setting.exprInfo.exprList[a].exprId;
}str+="<option"+b+' value="'+this.setting.exprInfo.exprList[a].exprId+'" data-need_appointment="'+this.setting.exprInfo.exprList[a].need_appointment+'">'+this.setting.exprInfo.exprList[a].exprName+"</option>";
}str+="</select></div>";if(this.setting.exprInfo&&this.setting.exprInfo.cityName&&!$("#_JS_sndSms_city_select_").html()){str+='<span id="JS_sms_change_city" class="Left" style="padding-top:9px;"><span style="color:#666;display:inline-block;padding:0 5px 0 15px;background:url('+this.bg+') -49px -61px no-repeat">'+this.setting.exprInfo.cityName+'</span><span><a href="javascript:;" style="color:#c9033b;" onclick="$._currentsendActGoodsBox.insertCitySelect();return false;">更换城市</a></span></span>';
}str+="</div>";if(this.setting.type!="quick_search"){$("#_JS_sndSms_expr_select_").html(str);}},insertCitySelect:function(){$("#JS_sms_change_city").hide();
var e=this;var b=this.cityInfo;if(b){var d="";var c;var a;d+='<div class="clearfix" style="height:43px;">';d+='<label class="Left">所在地：</label>';d+='<div class="_selectbox Left" style="height:25px;padding-top:5px;margin-right:5px;border:1px solid #ddd;" id="JS_sms_pro_sel_box"><select class="_sndsms_select" id="_JS_sndSms_province_list_" style="background: #fafafa;border:0px;margin:0;padding:0px;" onchange="$._currentsendActGoodsBox.provinceSelected(this.value);">';
d+='<option value="0">请选择省</option>';for(a in b){var f="";if(this.setting.defaultCityId&&b[a]&&b[a].cityList&&b[a].cityList[this.setting.defaultCityId]){f=' selected="selected"';
c=a;}d+='<option value="'+a+'"'+f+">"+b[a].provinceName+"</option>";}d+="</select></div>";d+='<div class="_selectbox Left" style="height:25px;padding-top:5px;border:1px solid #ddd;" id="JS_sms_city_sel_box" style="margin-left:12px;"><select class="_sndsms_select" id="_JS_sndSms_city_list_" onchange="$._currentsendActGoodsBox.citySelected(this.value,this.options[this.selectedIndex].innerHTML);"><option value="0">请选择市</option></select></div>';
d+="</div>";if(this.setting.type!="quick_search"){$("#_JS_sndSms_city_select_").html(d);}if(c){this.provinceSelected(c);}}else{this.initData(this.insertCitySelect);
}},provinceSelected:function(e){if(!parseInt(e)){return;}var b='<option value="0">请选择市</option>';var c;for(var a in this.cityInfo[e].cityList){var d="";
if(this.setting.defaultCityId&&a==this.setting.defaultCityId){d=' selected="selected"';c=[a,this.cityInfo[e].cityList[a].cityName];}b+='<option value="'+a+'"'+d+">"+this.cityInfo[e].cityList[a].cityName+"</option>";
}$("#_JS_sndSms_city_list_").html(b);this.selectedProvinceId=e;this.exprId=false;$("#JS_sms_pro_sel_box").css("border-color","#ddd");$("#JS_sms_epr_select_se").html('<option value="0">请选择体验馆</option>');
if(c){this.citySelected.apply(this,c);}},citySelected:function(d,b){if(!parseInt(d)){return;}var c=[];for(var a in this.cityInfo[this.selectedProvinceId].cityList[d].exprList){c.push({exprName:this.cityInfo[this.selectedProvinceId].cityList[d].exprList[a],exprId:a,position:this.cityInfo[this.selectedProvinceId].cityList[d].exprInfo[a].position,need_appointment:this.cityInfo[this.selectedProvinceId].cityList[d].exprInfo[a].need_appointment});
}this.setting.exprInfo={cityName:b,exprList:c};this.selectedCityId=d;this.exprId=false;$("#JS_sms_city_sel_box").css("border-color","#ddd");this.insertExprSelect();
},getCaptcha:function(a){if(a){$._currentsendActGoodsBox.captchaImg.attr("src",a);}else{$.getCaptcha($._currentsendActGoodsBox.captchaImg);}},remove:function(){if($._currentsendActGoodsBox&&$._currentsendActGoodsBox.dom){$($._currentsendActGoodsBox.dom).remove();
$.hideMask();$._currentsendActGoodsBox.hasShow=false;}},getIsNeedImgChap:function(){if(this.setting.isNeedImgChap){$._currentsendActGoodsBox.isNeedImgChap=(this.setting.isNeedImgChap==="1");
return;}$.ajax({url:"/solr_api/captcha/mobileCaptcha/check_open_image_checkcode.do?",dataType:"json",async:false,type:"GET",success:function(a){if(parseInt(a.image_check_flag)==1){$._currentsendActGoodsBox.isNeedImgChap=true;
}else{$._currentsendActGoodsBox.isNeedImgChap=false;}},error:function(a){$._currentsendActGoodsBox.isNeedImgChap=true;}});},send:function(){if(this.lock){return;
}var c=parseInt($._currentsendActGoodsBox.inpt.val().replace(/\D/g,""),10);$._currentsendActGoodsBox.inpt.val(c||"");var b=$._currentsendActGoodsBox.captcha.val();
if($._currentsendActGoodsBox.setting.type=="get_pm_bm"&&($._currentsendActGoodsBox.realname.val()+"").replace(/(^\s*)|(\s*$)/g,"")==""){$._currentsendActGoodsBox.msg("请填写您的真实姓名");
return;}if(!parseInt(this.exprId)&&this.setting.chooseExpr){$._currentsendActGoodsBox.msg("请选择离您最近的体验馆。");return;}if(!(c&&/^1\d{10}$/.test(c))){$._currentsendActGoodsBox.msg("请输入正确手机号码。");
return;}if($._currentsendActGoodsBox.isNeedImgChap){if(!b||b=="验证码"||!$._currentsendActGoodsBox.captcha_flag){$._currentsendActGoodsBox.msgBox.html("");
$._currentsendActGoodsBox.msg("请输入正确的验证码。");return;}}if($._currentsendActGoodsBox.setting.checkPhone&&!$._currentsendActGoodsBox.cellcaptcha_flag){$._currentsendActGoodsBox.msg("手机校验码有误。");
return;}$._currentsendActGoodsBox.msg("发送中...");$._currentsendActGoodsBox.btn.disabled=true;var d={};if($._currentsendActGoodsBox.setting.type=="get_limited_prize"){for(var a in $._currentsendActGoodsBox.setting){if(a!="captcha"&&a!=="captchaSrc"&&typeof $._currentsendActGoodsBox.setting[a]!="object"&&typeof $._currentsendActGoodsBox.setting[a]!="function"){d[a]=$._currentsendActGoodsBox.setting[a];
}}url="/solr_api/jmll/activity/getAdvanceCode.do?giftId="+$._currentsendActGoodsBox.setting.prize_id+"&exprId="+this.exprId+"&mobile="+c+"&checkCode="+cellcaptcha+"&checkType=get_limited_prize";
}if($._currentsendActGoodsBox.setting.type=="get_bk_tx"){url="/java_api/jmll/goods/bonusNoticeMobile.do?captcha="+b+"&goodsId="+$._currentsendActGoodsBox.setting.prize_id+"&mobile="+c+"&active_type=15&source_from=0&send_from="+($.cookie("MLLSEO")||"")+"&url="+encodeURIComponent(location.href);
window._ana&&window._ana.push(["trackEvent",this.setting.gaEvent||this.cfg.gaEvent,"开抢提醒_免费发送","NoStart_SendFree",c,"jjc_yhq"]);}if($._currentsendActGoodsBox.setting.type=="get_ms_tx"){url="/dispose/?act=add_user&mobile="+c+"&check_key="+cellcaptcha+"&id="+$._currentsendActGoodsBox.setting.act_id+"&captchaType=miaosha_baoming";
}if($._currentsendActGoodsBox.setting.type=="get_tg_tx"){url="/solr_api/jmll/groupBuy/noticeBandMobile.do?&mobile="+c+"&checkCode="+cellcaptcha+"&checkType=tg_baoming&goodsId="+$._currentsendActGoodsBox.setting.prize_id;
}if($._currentsendActGoodsBox.setting.type=="get_tg_bm"){url="/solr_api/jmll/groupBuy/apply.do?mobile="+c+"&checkCode="+cellcaptcha+"&captchaType=tg_baoming&goodsId="+$._currentsendActGoodsBox.setting.prize_id;
}if($._currentsendActGoodsBox.setting.type=="get_pm_bm"){url="/ajax_ajax.html?act=addAuctionUser";d={auction_id:this.setting.prize_id,expr_id:this.exprId,name:this.realname.val(),province:$("#_JS_sndSms_province_list_").val(),city:$("#_JS_sndSms_city_list_").val(),phone:c,captcha:b,source_from:0,active_type:11,url:encodeURIComponent(location.href)};
}$.ajax({url:url,data:d,type:$._currentsendActGoodsBox.cfg.ajaxType||"get",dataType:"json",success:function(e){$._currentsendActGoodsBox.getCaptcha();if(e.error=="0"){$._currentsendActGoodsBox.sendSuccessCB(e,c);
if($._currentsendActGoodsBox.setting.extSendSucCB&&typeof $._currentsendActGoodsBox.setting.extSendSucCB=="function"){$._currentsendActGoodsBox.setting.extSendSucCB();
}}else{$._currentsendActGoodsBox.msg(e.msg);$._currentsendActGoodsBox.btn.disabled=false;}},error:function(e){$._currentsendActGoodsBox.getCaptcha();$._currentsendActGoodsBox._reset_captcha();
$._currentsendActGoodsBox.msg("发送失败");$._currentsendActGoodsBox.btn.disabled=false;}});},sendSuccessCB:function(b,a){if(window._ana){_ana.push(["trackEvent",this.setting.gaEvent||this.cfg.gaEvent,"success",a,$._currentsendActGoodsBox.exprId||"unset",$._currentsendActGoodsBox.setting.click]);
}if(window._gaq){_gaq.push(["_trackEvent",this.setting.gaEvent||this.cfg.gaEvent,"success",$._currentsendActGoodsBox.setting.click]);}$.cookie("sendSmsPhone",a,{path:"/",expires:365,domain:".meilele.com"});
$._currentsendActGoodsBox.trackEvent();$._currentsendActGoodsBox.json=b;$._currentsendActGoodsBox.showSuccessBox();},showSuccessBox:function(){$("#_JS_sndSms_map_").hide();
$("#_JS_sndSms_title_").hide().parent().css({background:"none","border-bottom":"none"});$("#_JS_sms_box .sms_box_header").addClass("no-header-bg");$("#_JS_sms_box .sms_close_btn").addClass("gray");
$("#_JS_sms_box .sms_content").css("paddingTop","15px");$this=this;if($._currentsendActGoodsBox.setting.type=="get_limited_prize"){$("#_JS_sndSms_content_box").html('<div class="clearfix" style="color:#333;font-weight:bold;font-family:微软雅黑;font-size:14px;line-height:1.6;padding:0 0 70px 65px"><div style="float:left;width:50px;height:50px;background:url('+$this.bg+') 0 -55px no-repeat;"></div><div style="float:left; width:245px;margin-left:8px;"><div style="font-size:18px;">领取成功</div><div style="font-weight:normal;margin-top:4px;line-height:20px;color:#666;font-size:13px;">验证码将以短信形式发送至您的手机，请注意查收！</div></div></div></div>');
if($this.setting.qm_time&&$this.setting.use_time){$("#_JS_sndSms_content_box").append('<div class="suc_Sms_notice">温馨提示：仅限'+$this.setting.qm_time+"期间参与抢码，请于"+$this.setting.use_time+"期间到体验馆使用，每个订单只能使用1个验证码</div>");
}}else{if($._currentsendActGoodsBox.cfg.successSubTxt){$("#_JS_sndSms_content_box").html('<div class="clearfix" style="color:#333;font-weight:bold;font-family:微软雅黑;font-size:14px;line-height:1.6;padding:0 0 70px 65px"><div style="float:left;width:50px;height:48px;background:url('+$this.bg+') 0 -55px no-repeat;"></div><div style="float:left; width:245px;margin-left:8px;"><div style="font-size:18px;">'+$._currentsendActGoodsBox.cfg.successTxt+'</div><div style="font-weight:normal;margin-top:4px;line-height:20px;color:#666;font-size:13px;">'+$._currentsendActGoodsBox.cfg.successSubTxt+"</div></div></div></div>");
}else{$("#_JS_sndSms_content_box").html('<div style="color:#333;font-weight:bold;font-family:微软雅黑;font-size:14px;line-height:1.6;padding:0 0 70px 140px"><div style="height:48px;padding-left:55px;background:url('+$this.bg+') 0 -55px no-repeat;"><div style="font-size:18px; height:50px;line-height:45px;">'+($._currentsendActGoodsBox.cfg.successTxt||"发送成功！")+"</div></div></div>");
}}if(this.successAdInfo){var b=this.successAdInfo;var a='<div><a href="'+b.url+'" title="'+b.desc+'"><img src="'+$.__IMG+"/"+b.src+'"></a></div>';$("#_JS_sndSms_content_box").append(a);
}},msg:function(b,c){var a=c?"-42":"-27";b=b;$._currentsendActGoodsBox.msgBox.html(b);},keyPress:function(a){a=a||window.event;if(a.keyCode==13){$._currentsendActGoodsBox.send();
}},phoneOnBlur:function(b){var a=$._currentsendActGoodsBox.inpt.val();if(this.setting.type=="get_limited_prize"&&/^1(\d){10}$/.test(a)&&window._ana){window._ana.push(["trackEvent","special_gather_phone","blur",a,$._currentsendActGoodsBox.exprId||"unset",this.setting.description,this.setting.prize_id.split("_")[1]]);
}},_reset_captcha:function(){+$._currentsendActGoodsBox.captcha.val("");$._currentsendActGoodsBox.captcha_flag=false;$._currentsendActGoodsBox.captcha_icon[0].className="_check_icon";
},hiddenPhone:function(){var a=$._currentsendActGoodsBox.inpt.val().replace(/\D/,"");var b=$("#_JS_sendSms_phone_icon");$._currentsendActGoodsBox.inpt.val(a);
if(/^1\d{10}$/.test(a)){$._currentsendActGoodsBox.setting.pNumber=a;$._currentsendActGoodsBox.msgBox.html("");b.addClass("sms_captcha_success").show();
b.removeClass("sms_captcha_error").show();$._currentsendActGoodsBox.setting.flag=1;}else{b.removeClass("sms_captcha_success").show();b.addClass("sms_captcha_error").show();
$._currentsendActGoodsBox.msg("请输入正确手机号码。");}},getCellCaptcha:function(){var e=this;var c=parseInt($._currentsendActGoodsBox.inpt.val().replace(/\D/g,""),10);
$._currentsendActGoodsBox.inpt.val(c||"");var b=$._currentsendActGoodsBox.captcha.val();if(!parseInt(this.exprId)&&this.setting.chooseExpr){$._currentsendActGoodsBox.msg("请选择离您最近的体验馆。");
return;}if(!(c&&/^1\d{10}$/.test(c))){$._currentsendActGoodsBox.msg("请输入正确手机号码。");return;}if($._currentsendActGoodsBox.isNeedImgChap){if(!b||b=="验证码"||!$._currentsendActGoodsBox.captcha_flag){$._currentsendActGoodsBox.msgBox.html("");
$._currentsendActGoodsBox.msg("请输入正确的验证码。");return;}}if(this.setting.flag==1){if($._currentsendActGoodsBox.isNeedImgChap){var b=$("#_JS_sndSms_captcha_").get(0).value;
}else{var b="";}if($._currentsendActGoodsBox.isNeedImgChap&&b.length!=4){$._currentsendActGoodsBox.msg("您输入的验证码不正确。");$._currentsendActGoodsBox.getCaptcha();
return;}else{if($._currentsendActGoodsBox.captcha_flag){var a=this.setting.pNumber;$._currentsendActGoodsBox.msgBox.html("");var d="/solr_api/captcha/mobileCaptcha/create_send_check_captcha.do";
var f="?phoneNumber="+a+(this.setting.chooseExpr?("&exprId="+this.exprId):"")+"&durationTime=120&source_from=0&captchaType="+($._currentsendActGoodsBox.cfg.captchaType||$._currentsendActGoodsBox.setting.captcha_type||$._currentsendActGoodsBox.setting.type)+"&captcha="+b;
if($._currentsendActGoodsBox.setting.activityType){f=f+"&activeType="+$._currentsendActGoodsBox.setting.activityType;}if(this.cfg.createCaptchaUrl){d=this.cfg.createCaptchaUrl;
f+="&sendSource="+($._currentsendActGoodsBox.setting.sendSource||this.cfg.sendSource)+"&sendType="+($._currentsendActGoodsBox.setting.sendType||this.cfg.sendType);
}d+=f;$.ajax({url:d,type:"GET",dataType:"json",success:function(h){if(h.error==0){$("#_JS_sndSms_prz_btn2_").get(0).style.display="none";$("#_JS_sndSms_prz_tishiA").get(0).style.color="#999999";
var g=$("#_JS_sndSms_input_").get(0).value;$("#_JS_sndSms_prz_tishiA").get(0).innerHTML="校验码已发送至手机"+g+"请查收";$("#_JS_sndSms_prz_btn6_").get(0).style.display="none";
$("#_JS_sndSms_prz_tishiA").get(0).style.display="inline-block";$._currentsendActGoodsBox.getNewCaptcha();}else{var i=h.msg||"手机校验码发送失败！";$._currentsendActGoodsBox.msg(i);
$._currentsendActGoodsBox.getCaptcha();if($._currentsendActGoodsBox.isNeedImgChap){$._currentsendActGoodsBox._reset_captcha();}}}});}}}},getNewCaptcha:function(){var a=$("#_JS_sndSms_prz_btn5_").get(0),b=$("#_JS_sndSms_prz_btn6_").get(0);
a.style.display="inline-block";$._currentsendActGoodsBox._mobile_captcha_times_left=$._currentsendActGoodsBox._mobile_captcha_times_limit_g;a.innerHTML="("+$._currentsendActGoodsBox._mobile_captcha_times_limit_g+"秒后) 重新获取短信";
$._currentsendActGoodsBox.timeLoop2=setInterval(function(){a.innerHTML="("+$._currentsendActGoodsBox._mobile_captcha_times_left+"秒后) 重新获取短信";$._currentsendActGoodsBox._mobile_captcha_times_left--;
if($._currentsendActGoodsBox._mobile_captcha_times_left<=0){clearInterval($._currentsendActGoodsBox.timeLoop2);$._currentsendActGoodsBox._mobile_captcha_times_left=$._currentsendActGoodsBox._mobile_captcha_times_limit_g;
a.style.display="none";b=$("#_JS_sndSms_prz_btn6_").get(0);if(b){b.style.display="inline-block";}$._currentsendActGoodsBox.getCaptcha();$._currentsendActGoodsBox._reset_captcha();
$("#_JS_sndSms_prz_tishiA").get(0).style.display="none";}},1000,a);},getCaptchaAgin:function(){$._currentsendActGoodsBox.getCellCaptcha();},value_null:function(c){var d=$("#_JS_sndSms_prz_btn2_").get(0),b=$("#_JS_sndSms_prz_btn4_").get(0),a=$("#_JS_sndSms_prz_btn5_").get(0),e=$("#_JS_sndSms_prz_tishiA").get(0);
if(a.innerHTML=="(0秒后) 重新获取短信"||a.innerHTML=="(-1秒后) 重新获取短信"){$._currentsendActGoodsBox.setting.pNumber=0;$._currentsendActGoodsBox.setting.flag=0;d.style.display="inline-block";
a.style.display="none";e.style.display="none";$._currentsendActGoodsBox.msgBox.html("");}if(a.style.display=="inline-block"){$("#_JS_sndSms_prz_cellcaptcha_").get(0).value="";
}},checkCellCaptcha:function(){cellcaptcha=$("#_JS_sndSms_prz_cellcaptcha_").get(0).value;if(cellcaptcha.length!=6){$._currentsendActGoodsBox.msg("校验码有误。");
$._currentsendActGoodsBox.cellcaptcha_flag=false;return;}else{$._currentsendActGoodsBox.msgBox.html("");$._currentsendActGoodsBox.cellcaptcha_flag=true;
$._currentsendActGoodsBox.setting.checkPhone=cellcaptcha;}},trackEvent:function(a){a=a||"13800138000";if(window.goSpread){var b={};var c={send_sms:{phone:a,email:"mllcustomer@meilele.com"}};
b.data=c;window.goSpread(["_trackRTEvent",b]);}window.goGdt&&window.goGdt([["add_action","SHOP_VIEW",a,"mllcustomer@meilele.com"]]);window.criteo_q=[{event:"trackTransaction",id:(a-0).toString(36)+"_"+(new Date-0).toString(36).replace(".",""),item:[{id:"sms",price:0,quantity:1}]}];
window.goCriteo&&window.goCriteo(true);}};$.sendActGoods.prototype.init.prototype=$.sendActGoods.prototype;
/*dengyun*243502:2016-12-06 09:09:00*/